# Customer Churn Prediction

## Project Overview

This project focuses on building a production-ready machine learning pipeline
to predict telecom customer churn. The goal is to design an end-to-end ML workflow
that follows industry best practices, from data preprocessing to model training
and deployment readiness.

## Project Structure

- `data/` – dataset storage (excluded from GitHub)
- `notebooks/` – exploratory analysis and inspection
- `src/` – production-grade Python modules
- `tests/` – unit tests (in progress)

## Current Progress

Note: Initial exploratory analysis and data cleaning were performed prior to production refactoring to validate data quality, remove inconsistencies, and prevent leakage. This repository focuses on the production-ready ML lifecycle, including preprocessing standardization, baseline modeling, evaluation, and deployment preparation.

- Modular project structure established

- Data cleaning and preprocessing refactored from notebooks to Python modules

- Baseline modeling implemented - The baseline model achieves an AUC-ROC of 77%, indicating good discriminatory power. It prioritizes recall for churners (82%), successfully identifying most customers at risk of churn, at the expense of precision (37%). This behavior is acceptable at the baseline stage, as missing churners is typically more costly than false positives in telecom retention strategies.

- The baseline modeling was reimplemented again, after the correction of a wrongly applied scaling on the encoded categorical features. The new results show AUC-ROC of 77% which is the same as before, with a recall of 10% and precision of 79% for churners. This indicates the model was not able to identify most customer at risk of churn, which is not ideal. Further feature engineering and model tuning are needed to improve recall.

- Error analysis conducted to identify misclassification patterns and what was discovered was that among the false negatives (churners predicted as non-churners), a significant portion had high tenure months, low monthly charges and high total charges, indicating that long-term customers with lower bills and higher total charges were being overlooked by the model. Conversely, false positives (non-churners predicted as churners) often exhibited moderate tenure but higher monthly charges, suggesting that customers with mid-level engagement but higher costs were being misclassified.

- Error analysis was conducted again after removing the scaling for the numeric features before the baseline modeling. The new results show AUC-ROC of 85%, with a recall of 58% and precision of 62%, these indicate that false negatives (churners predicted as non-churners) tend to have long tenure months, lower monthly charges and higher total charges, suggesting that loyal customers with lower bills are being overlooked by the model. On the other hand, false positives (non-churners predicted as churners) often have short/middle tenure months, higher monthly charges, and lower total charges, indicating that customers with higher bills are being misclassified.

- Two hypothesis was formed based on the error analysis:
  1. Customers with high tenure months, low monthly charges and high total charges are less likely to churn, so the model may be misclassifying them due to their strong loyalty despite lower bills.
  2. Customers with moderate tenure but higher monthly charges may be more sensitive to price increases or service issues, leading to misclassification as churners.

- Pipeline for preprocessing and modeling built and tested on the jupyter notebook. The same result as the baseline modeling was achieved. which is AUC-ROC of 85%, with a recall of 58% and precision of 62% for churners. This indicates that the pipeline is functioning correctly and can be further enhanced with feature engineering and model tuning.

- Feature engineering in progress to create new features based on insights from error analysis. Initial features include:
  - `charges_per_months`: Average charges per month to capture billing patterns.
  - `high_monthly_charges`: Binary feature indicating if monthly charges exceed a certain threshold.
  - `change_ratio`: Ratio of total charges to tenure months to identify customers with increasing costs over time.

  - and these features have been added to the training and validation sets. The results shows AUC-ROC of 85%, with a recall of 57% and precision of 63% for churners. This indicates that the new features have not significantly improved model performance yet, further feature engineering and tuning are needed.

  - Then, the log transformation was perfomed on the Tenure months and Monthly charges features to reduce skewness and improve model performance. After applying the log transformation, the model achieved an AUC-ROC of 77%, with a recall of 57% and precision of 64% for churners. This indicates that the log transformation has slightly improved the model's precision, but unable to improve the recall. Further feature engineering and tuning are still needed.

  - statsmodels analysis was performed to identify statistically significant features. Based on the odd ratio and p-values, features such as 'Dependent_No', 'Internet Service_Fiber optic', 'Partner_No', and 'Contract_Month-to-month' were found to be significant predictors of churn. These insights will guide further feature engineering and model refinement.

  - with these insight, new features were created such as 'high monthly charges', 'single short term', (Dependent_No + 'Tenure month < 6'), 'fiber monthly' (Internet Service_Fiber optic + Contract_Month-to-month), and 'no family' (Partner_No + Dependent_No). After the evaluation it shows these features do not improve the model performance, it further worsened the recall performance to 55% and precision to 63%, except the no family feature which improved the the recall and precision to 56% and 64% respectively and still maintain the AUC-ROC of 85%.

  - The probability threshold was tuned to optimize the trade-off between precision and recall. By adjusting the threshold to 0.3, the model achieved a significant increment in recall of 79% from 56% and precision decrease to 51% from 64% for churners and still maintain the AUC-ROC of 85%, this is a better result because it improves the identification of at-risk customers while maintaining a reasonable level of precision.

## Tech Stack

- Python
- jupyter Notebooks
- Pandas
- NumPy
- Matplotlib & Seaborn
- Scikit-learn
- statsmodels
- Git & GitHub

## Steps

- Baseline modeling
- Error analysing
- Build full preprocessing + model pipeline
- Feature engineering
- Artifact creation
- Model training and tuning
- Final evaluation (test set)
- Unit testing
- Model packaging and deployment readiness
- Monitoring and maintenance plan

## Author

Issa Muiz
